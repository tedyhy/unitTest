<!DOCTYPE html>
<html>

<head>
	<title>Range</title>
	<link rel="stylesheet" href="../codemirror/lib/codemirror.css">
	<script src="../codemirror/lib/codemirror.js"></script>
	<script src="../codemirror/mode/javascript/javascript.js"></script>
	<script src="../codemirror/mode/xml/xml.js"></script>
	<script src="../codemirror/mode/htmlmixed/htmlmixed.js"></script>
	<style type="text/css">
		.CodeMirror {
			height: auto;
		}
	</style>
</head>

<body>
<h1>Range</h1>
<p>关键词：range|selection</p>
<p>出处：HTML5&CSS3权威指南 P95</p>
<p>一、Range对象 & Selection对象</p>
<p>1.概念<br>一个Range对象代表页面上的一段连续区域。通过Range对象，可以获取或修改页面上的任何区域。</p>
<textarea class="codemirror">
var range = document.createRange(); // 显示创建一个空的Range对象（该Range对象未包含任何内容）。
</textarea>
<p>每一个浏览器窗口及每一个窗口中的页面都具有一个Selection对象，代表用户鼠标在页面中所选取的区域。<br>
每一个Selection对象都具有一个或多个Range对象。</p>
<textarea class="codemirror">
var selection = window.getSelection();
var selection2 = document.getSelection();
</textarea>
<p>获取Selection对象的某个Range对象。</p>
<textarea class="codemirror">
var range = document.getSelection().getRangeAt(0);
var rangecount = document.getSelection().rangeCount(); //判断用户是否用鼠标选取了内容，默认0。
</textarea>
<p>2.Range对象</p>
<p>Range对象属性，如图1。</p>
<textarea class="codemirror">
// 判断Range对象所代表的区域的开始点和结束点是否在相同位置，如果在则true，否则false。
1.collapsed 	{Boolean}

// 返回Range对象所代表区域位于什么节点中。此节点为包含该区域的最底层节点，可能是一个DOM元素节点，
// 可能是一个文本节点。
2.commonAncestorContainer		{Node}

// 返回Range对象所代表区域的起点位于什么节点中。此节点为包含该区域起点的最底层节点。
3.startContainer 	{Node}

// 返回Range对象所代表区域的终点位于什么节点中。此节点为包含该区域终点的最底层节点。
4.endContainer 	{Node}

// 返回Range对象所代表区域的起点与包含该起点的节点的起点间距离。
5.startOffset 	{Int}

// 返回Range对象所代表区域的终点与包含该终点的节点的起点间距离。
6.endOffset 	{Int}
</textarea>
<p>3.Range对象的3个方法，例子1。</p>
<p>selectNode、selectNodeContents、deleteContents方法</p>
<textarea class="codemirror">
// html片段
<div id="div" style="background-color:#e0a0b0;width:300px;height:50px">元素中的内容</div>
<button onclick="deleteRangeContents(true);">删除内容</button>
<button onclick="deleteRangeContents(false);">删除元素</button>
// js
function deleteRangeContents(onlyContent){
	var div = document.getElementById('div'),
		rangeObj = document.createRange();
	if (onlyContent) {
		rangeObj.selectNodeContents(div);
	} else {
		rangeObj.selectNode(div);
	}
	rangeObj.deleteContents();
}
</textarea>
<p>4.Range对象的6个方法，例子2。</p>
<p>setStart、setEnd、setStartBefore、setStartAfter、setEndBefore、setEndAfter方法</p>
<textarea class="codemirror">
// 如：rangeObj.setStart(node, offsetInsideNode)
// 如果node为DOM元素节点，则offsetInsideNode为节点node第几个子节点的结束位置。
// 如果node为文字节点，则offsetInsideNode为节点node第几个文字的结束位置。
// 将这个位置作为rangeObj的起始位置。
1.setStart

// 如：rangeObj.setEnd(node, offsetInsideNode)
// 如果node为DOM元素节点，则offsetInsideNode为节点node第几个子节点的结束位置。
// 如果node为文字节点，则offsetInsideNode为节点node第几个文字的结束位置。
// 将这个位置作为rangeObj的结束位置。
2.setEnd

// 如：rangeObj.setStartBefore(node)
// 将node节点的起点指定为rangeObj的起始位置。
3.setStartBefore

// 如：rangeObj.setStartAfter(node)
// 将node节点的终点指定为rangeObj的起始位置。
4.setStartAfter

// 如：rangeObj.setEndBefore(node)
// 将node节点的起点指定为rangeObj的终点位置。
5.setEndBefore

// 如：rangeObj.setEndAfter(node)
// 将node节点的终点指定为rangeObj的终点位置。
6.setEndAfter
</textarea>




<p>图1：</p>
<img src="../img/range.png">
<script src="../js/base.js"></script>
<p>参考：<br></p>
1.<a href="http://www.zhangxinxu.com/wordpress/?p=1591" target="_blank">JS Range HTML文档/文字内容选中、库及应用介绍</a><br>
2.<a href="http://www.quirksmode.org/dom/w3c_range.html" target="_blank">W3C DOM Compatibility - Range</a>
</body>

</html>
